<ion-header class="ion-no-border drop-shadow-md">
  <ion-toolbar>
    <ion-buttons slot="start" class="-mr-4">
      <ion-back-button></ion-back-button>
    </ion-buttons>
    <ion-title class="text-bold">
      {{idPermintaan? 'Ubah Permintann (Revisi)' : 'Tambah Permintaan'}}
    </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <div *ngIf="kategori; else noKategori" [ngClass]="'item-' + kategori.kode">
    <ng-container *ngIf="penolak as pn">
      <div
        class="ion-padding-start ion-padding-end pt-2 pb-2 rounded-xl text-danger ion-margin-bottom border border-danger">
        <div class="-mt-1">
          <small>Catatan Revisi</small>
          <div class="ion-text-capitalize"><b>{{pn.catatan}}</b></div>
        </div>
      </div>
    </ng-container>
  
    <div class="text-bold mb-2" [ngClass]="'text-' + kategori.kode">{{kategori.nama}}</div>
    <form [formGroup]="userForm">
      <ion-list class="pb-0 item-opacity-100">
        <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
          <ion-label position="floating" color="medium">Nama Lengkap (Otomatis Terisi)</ion-label>
          <ion-input formControlName="namaLengkap" class="-mb-2 ion-text-capitalize"></ion-input>
        </ion-item>
        <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
          <ion-label position="floating" color="medium">Email (Otomatis Terisi)</ion-label>
          <ion-input formControlName="email" class="-mb-2"></ion-input>
        </ion-item>
        <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
          <ion-label position="floating" color="medium">Nomer Pegawai (Otomatis Terisi)</ion-label>
          <ion-input formControlName="noPegawai" class="-mb-2"></ion-input>
        </ion-item>
        <ion-item fill="outline" class="item-rounded-xl ">
          <ion-label position="floating" color="medium">Nomer HP (Otomatis Terisi)</ion-label>
          <div slot="start" class="border-r pr-3 mr-3" style="border-color: var(--ion-color-light-shade);">
            {{userForm.get('kodeNoTlp').value}}</div>
          <ion-input formControlName="noTlp" class="-mb-2"></ion-input>
        </ion-item>
      </ion-list>
    </form>
    <hr class="bg-light ion-margin-top mb-2">
  
    <form [formGroup]="permintaanForm">
      
      <container-element [ngSwitch]="kategori.kode">
        <!-- FORM RDP =============================================================== -->
        <div *ngSwitchCase="'rdp'">
          <ion-list>
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
              <ion-label position="floating" color="medium">Alamat RDP / Fasum</ion-label>
              <ion-input formControlName="alamat" class="-mb-2 ion-text-capitalize"></ion-input>
            </ion-item>
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl item-opacity-100"
              (click)="bukaTgl(tglModal, 'Perbaikan')">
              <ion-icon slot="start" name="calendar" color="medium" style="margin-top: 11px;"></ion-icon>
              <ion-label position="floating" color="medium">Tanggal Perbaikan</ion-label>
              <ion-input [value]="permintaanForm.get('tgl').value | date:'dd MMMM yyyy'" readonly="true"
                class="-mb-2 ion-text-capitalize"></ion-input>
            </ion-item>
            <div class="bg-background rounded-xl border ion-padding ion-margin-bottom">
              <div class="text-bold ion-margin-bottom">Variasi Perbaikan RDP & Fasum</div>
              <!-- <hr class="bg-light ion-margin-top ion-margin-bottom"> -->
              <div formArrayName="variasi" *ngFor="let pe of permintaanForm.get('variasi')['controls']; let i = index; let c = count"
                class="ion-padding border rounded-xl ion-margin-bottom">
                <ng-container [formGroupName]="i">
                  <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl" style="height: 57px;">
                    <ion-label position="floating" color="medium">Jenis Kerusakan</ion-label>
                    <ion-select formControlName="jenis" [interfaceOptions]="{ mode: 'ios', cssClass: 'item-rdp' }"
                      okText="Pilih" cancelText="Batal" style="margin-bottom: 0px;">
                      <ion-select-option value="Perbaikan Atap">Perbaikan Atap</ion-select-option>
                      <ion-select-option value="Perbaikan Pintu">Perbaikan Pintu</ion-select-option>
                      <ion-select-option value="Pergantian Lampu">Pergantian Lampu</ion-select-option>
                      <ion-select-option value="Perbaikan Lantai">Perbaikan Lantai</ion-select-option>
                      <ion-select-option value="Lainnya">Lainnya</ion-select-option>
                    </ion-select>
                  </ion-item>
                  <div *ngIf="permintaanForm.get('variasi')['controls'][i].get('foto') as ft" class="rounded-xl border"
                    style="min-height: 57px;">
                    <div class="w-full flex items-center gap-3">
                      <ion-label color="medium" class="w-full ion-padding transition-transform"
                        [style.transform]="ft.value? 'translate(-22px, -12px) scale(0.78)' : ''" (click)="ambilFoto(ft)">
                        Foto Kerusakan
                      </ion-label>
                      <div class="ion-padding flex-shrink-0 flex transition-transform" style="font-size: 21pt;"
                        [style.transform]="ft.value? 'translate(7px, -12px) scale(0.75)' : ''">
                        <ion-icon *ngIf="ft.value" slot="end" name="close-circle-outline" color="danger"
                          (click)="ft.setValue('')"></ion-icon>
                        <ion-icon *ngIf="!ft.value" slot="end" name="camera" color="medium" (click)="ambilFoto(ft)">
                        </ion-icon>
                      </div>
                    </div>
                    <div *ngIf="ft.value" class="ion-padding flex" style="margin-top: -38px;">
                      <img [src]="ft.value" alt="Foto Kerusakan" class="w-full rounded-lg">
                    </div>
                  </div>
                  <!-- <ion-item fill="outline" class="item-rounded-xl">
                    <ion-label color="medium">Foto Kerusakan</ion-label>
                    <ion-icon slot="end" name="camera" color="medium"></ion-icon>
                    <ion-input formControlName="foto" class="-mb-2" (ionFocus)="ambilFoto()"></ion-input>
                  </ion-item> -->
                  <div *ngIf="c > 1" class="ion-padding-top text-medium text-center" (click)="hapusVariasi(i)">Hapus Variasi
                    Perbaikan</div>
                </ng-container>
              </div>
              <div class="text-bold text-rdp text-center" (click)="tambahVariasi()">+ Tambah Variasi Perbaikan</div>
            </div>
    
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
              <ion-label position="floating" color="medium">Catatan </ion-label>
              <ion-textarea formControlName="catatan" placeholder="Tulis Catatan..." class="first-uppercase"></ion-textarea>
            </ion-item>
          </ion-list>
        </div>
    
        <!-- FORM furniture ========================================================= -->
        <div *ngSwitchCase="'furniture'">
          <ion-list class="pb-0">
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
              <ion-label position="floating" color="medium">Alamat Pengiriman Furniture</ion-label>
              <ion-input formControlName="alamat" class="-mb-2 ion-text-capitalize"></ion-input>
            </ion-item>
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl item-opacity-100"
              (click)="bukaTgl(tglModal, 'Diperlukan')">
              <ion-icon slot="start" name="calendar" color="medium" style="margin-top: 11px;"></ion-icon>
              <ion-label position="floating" color="medium">Tanggal Diperlukan</ion-label>
              <ion-input [value]="permintaanForm.get('tgl').value | date:'dd MMMM yyyy'" readonly="true"
                class="-mb-2 ion-text-capitalize"></ion-input>
            </ion-item>
            <div class="bg-background rounded-xl border ion-padding ion-margin-bottom">
              <div class="text-bold ion-margin-bottom">Variasi Furniture / Peralatan Rumah</div>
              <div formArrayName="variasi" *ngFor="let pe of permintaanForm.get('variasi')['controls']; let i = index; let c = count;"
                class="ion-padding border rounded-xl ion-margin-bottom">
                <ng-container [formGroupName]="i">
                  <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl" style="max-height: 57px;">
                    <ion-label position="floating" color="medium">Nama Furniture</ion-label>
                    <ion-input formControlName="nama" class="-mb-2 ion-text-capitalize"
                      (click)="bukaAutocomplete(autocomplateModal, 'furniture', permintaanForm.get('variasi')['controls'][i].get('nama'))">
                    </ion-input>
                    <!-- <ion-select formControlName="nama" [interfaceOptions]="{ mode: 'ios', cssClass: 'item-furniture' }"
                      okText="Pilih" cancelText="Batal" class="mb-px">
                      <ion-select-option value="a">Pilihan A</ion-select-option>
                      <ion-select-option value="b">Pilihan B</ion-select-option>
                      <ion-select-option value="c">Pilihan C</ion-select-option>
                      <ion-select-option value="d">Lainnya</ion-select-option>
                    </ion-select> -->
                  </ion-item>
                  <div class="flex gap-3">
                    <ion-item fill="outline" class="item-rounded-xl">
                      <ion-label position="floating" color="medium" class="text-center">Jumlah</ion-label>
                      <ion-input formControlName="jumlah" type="number" class="-mb-2 ion-text-capitalize text-center">
                      </ion-input>
                    </ion-item>
                    <ion-item fill="outline" class="item-rounded-xl">
                      <ion-label position="floating" color="medium" class="text-center">Satuan</ion-label>
                      <ion-input formControlName="satuan" class="-mb-2 ion-text-capitalize text-center"></ion-input>
                    </ion-item>
                  </div>
                  <div *ngIf="c > 1" class="ion-padding-top text-medium text-center" (click)="hapusVariasi(i)">Hapus Variasi
                    Furniture</div>
                </ng-container>
              </div>
              <div class="text-bold text-furniture text-center" (click)="tambahVariasi()">+ Tambah Furniture</div>
            </div>
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
              <ion-label position="floating" color="medium">Catatan </ion-label>
              <ion-textarea formControlName="catatan" placeholder="Tulis Catatan..." class="first-uppercase"></ion-textarea>
            </ion-item>
          </ion-list>
        </div>
    
        <!-- FORM rumput ============================================================ -->
        <div *ngSwitchCase="'rumput'">
          <ion-list class="pb-0">
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl item-opacity-100"
              (click)="bukaTgl(tglModal, 'Pemotongan')">
              <ion-icon slot="start" name="calendar" color="medium" style="margin-top: 11px;"></ion-icon>
              <ion-label position="floating" color="medium">Harapan Tanggal Pemotongan</ion-label>
              <ion-input [value]="permintaanForm.get('tgl').value | date:'dd MMMM yyyy'" readonly="true"
                class="-mb-2 ion-text-capitalize"></ion-input>
            </ion-item>
            <div class="bg-background rounded-xl border ion-padding ion-margin-bottom">
              <div class="text-bold ion-margin-bottom">Potong Rumput / Tebang Pohon</div>
              <div formArrayName="variasi" *ngFor="let pe of permintaanForm.get('variasi')['controls']; let i = index; let c = count;"
                class="ion-padding border rounded-xl ion-margin-bottom">
                <ng-container [formGroupName]="i">
                  <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
                    <ion-label position="floating" color="medium">Lokasi Rumput / Pohon </ion-label>
                    <ion-input formControlName="lokasi" class="-mb-2 ion-text-capitalize"></ion-input>
                  </ion-item>
    
                  <!-- <ion-item fill="outline" class="item-rounded-xl">
                    <ion-label position="floating" color="medium">Foto Lokasi Pohon / Rumput</ion-label>
                    <ion-input formControlName="foto" class="-mb-2"></ion-input>
                    <ion-icon slot="end" name="camera" color="medium"></ion-icon>
                  </ion-item> -->
                  <div *ngIf="permintaanForm.get('variasi')['controls'][i].get('foto') as ft" class="rounded-xl border"
                    style="min-height: 57px;">
                    <div class="w-full flex items-center gap-3">
                      <ion-label color="medium" class="w-full ion-padding transition-transform"
                        [style.transform]="ft.value? 'translate(-22px, -12px) scale(0.78)' : ''" (click)="ambilFoto(ft)">
                        Foto Lokasi
                      </ion-label>
                      <div class="ion-padding flex-shrink-0 flex transition-transform" style="font-size: 21pt;"
                        [style.transform]="ft.value? 'translate(7px, -12px) scale(0.75)' : ''">
                        <ion-icon *ngIf="ft.value" slot="end" name="close-circle-outline" color="danger"
                          (click)="ft.setValue('')"></ion-icon>
                        <ion-icon *ngIf="!ft.value" slot="end" name="camera" color="medium" (click)="ambilFoto(ft)">
                        </ion-icon>
                      </div>
                    </div>
                    <div *ngIf="ft.value" class="ion-padding flex" style="margin-top: -38px;">
                      <img [src]="ft.value" alt="Foto Kerusakan" class="w-full rounded-lg">
                    </div>
                  </div>
    
                  <div *ngIf="c > 1" class="ion-padding-top text-medium text-center" (click)="hapusVariasi(i)">Hapus
                    Pemotongan/Tebang</div>
                </ng-container>
              </div>
              <div class="text-bold text-rumput text-center" (click)="tambahVariasi()">+ Tambah Pemotongan/Tebang</div>
            </div>
    
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
              <ion-label position="floating" color="medium">Catatan </ion-label>
              <ion-textarea formControlName="catatan" placeholder="Tulis Catatan..." class="first-uppercase"></ion-textarea>
            </ion-item>
          </ion-list>
        </div>
    
        <!-- FORM ac ================================================================ -->
        <div *ngSwitchCase="'ac'">
          <ion-list class="pb-0">
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
              <ion-label position="floating" color="medium">Lokasi AC</ion-label>
              <ion-input formControlName="alamat" class="-mb-2 ion-text-capitalize"></ion-input>
            </ion-item>
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl item-opacity-100"
              (click)="bukaTgl(tglModal, 'Perawatan & Perbaikan')">
              <ion-icon slot="start" name="calendar" color="medium" style="margin-top: 11px;"></ion-icon>
              <ion-label position="floating" color="medium">Tanggal Perawatan & Perbaikan</ion-label>
              <ion-input [value]="permintaanForm.get('tgl').value | date:'dd MMMM yyyy'" readonly="true"
                class="-mb-2 ion-text-capitalize"></ion-input>
            </ion-item>
            <div class="bg-background rounded-xl border ion-padding ion-margin-bottom">
              <div class="text-bold ion-margin-bottom">Variasi Perawatan & Perbaikan AC</div>
              <div formArrayName="variasi" *ngFor="let pe of permintaanForm.get('variasi')['controls']; let i = index; let c = count;"
                class="ion-padding border rounded-xl ion-margin-bottom">
                <ng-container [formGroupName]="i">
                  <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl" style="height: 57px;">
                    <ion-label position="floating" color="medium">Jenis Kerusakan</ion-label>
                    <ion-select formControlName="jenis" [interfaceOptions]="{ mode: 'ios', cssClass: 'item-ac' }"
                      okText="Pilih" cancelText="Batal" style="margin-bottom: 0px;">
                      <ion-select-option value="AC Bocor/Meneteskan Air">AC Bocor/Meneteskan Air</ion-select-option>
                      <ion-select-option value="AC Tidak Dingin">AC Tidak Dingin</ion-select-option>
                      <ion-select-option value="AC Sering Nyala/Mati">AC Sering Nyala/Mati</ion-select-option>
                      <ion-select-option value="Bunyi AC Keras">Bunyi AC Keras</ion-select-option>
                      <ion-select-option value="Lainnya">Lainnya</ion-select-option>
                    </ion-select>
                  </ion-item>
                  <!-- <ion-item fill="outline" class="item-rounded-xl">
                    <ion-label position="floating" color="medium">Foto Kerusakan</ion-label>
                    <ion-input formControlName="foto" class="-mb-2"></ion-input>
                    <ion-icon slot="end" name="camera" color="medium"></ion-icon>
                  </ion-item> -->
                  <div *ngIf="permintaanForm.get('variasi')['controls'][i].get('foto') as ft" class="rounded-xl border"
                    style="min-height: 57px;">
                    <div class="w-full flex items-center gap-3">
                      <ion-label color="medium" class="w-full ion-padding transition-transform"
                        [style.transform]="ft.value? 'translate(-22px, -12px) scale(0.78)' : ''" (click)="ambilFoto(ft)">
                        Foto Lokasi
                      </ion-label>
                      <div class="ion-padding flex-shrink-0 flex transition-transform" style="font-size: 21pt;"
                        [style.transform]="ft.value? 'translate(7px, -12px) scale(0.75)' : ''">
                        <ion-icon *ngIf="ft.value" slot="end" name="close-circle-outline" color="danger"
                          (click)="ft.setValue('')"></ion-icon>
                        <ion-icon *ngIf="!ft.value" slot="end" name="camera" color="medium" (click)="ambilFoto(ft)">
                        </ion-icon>
                      </div>
                    </div>
                    <div *ngIf="ft.value" class="ion-padding flex" style="margin-top: -38px;">
                      <img [src]="ft.value" alt="Foto Kerusakan" class="w-full rounded-lg">
                    </div>
                  </div>
                  <div *ngIf="c > 1" class="ion-padding-top text-medium text-center" (click)="hapusVariasi(i)">Hapus Variasi
                    Kerusakan</div>
                </ng-container>
              </div>
              <div class="text-bold text-ac text-center" (click)="tambahVariasi()">+ Tambah Variasi Kerusakan</div>
            </div>
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
              <ion-label position="floating" color="medium">Catatan </ion-label>
              <ion-textarea formControlName="catatan" placeholder="Tulis Catatan..." class="first-uppercase"></ion-textarea>
            </ion-item>
          </ion-list>
        </div>
    
        <!-- FORM atk =============================================================== -->
        <div *ngSwitchCase="'atk'">
          <ion-list class="pb-0">
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
              <ion-label position="floating" color="medium">Lokasi Kerja</ion-label>
              <ion-input formControlName="alamat" class="-mb-2 ion-text-capitalize"></ion-input>
            </ion-item>
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl item-opacity-100"
              (click)="bukaTgl(tglModal, 'Diperlukan')">
              <ion-icon slot="start" name="calendar" color="medium" style="margin-top: 11px;"></ion-icon>
              <ion-label position="floating" color="medium">Tanggal Diperlukan</ion-label>
              <ion-input [value]="permintaanForm.get('tgl').value | date:'dd MMMM yyyy'" readonly="true"
                class="-mb-2 ion-text-capitalize"></ion-input>
            </ion-item>
            <div class="bg-background rounded-xl border ion-padding ion-margin-bottom">
              <div class="text-bold ion-margin-bottom">Variasi Permintaan ATK</div>
              <div formArrayName="variasi" *ngFor="let pe of permintaanForm.get('variasi')['controls']; let i = index; let c = count"
                class="ion-padding border rounded-xl ion-margin-bottom">
                <ng-container [formGroupName]="i">
                  <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl" style="max-height: 57px;">
                    <ion-label position="floating" color="medium">Nama ATK</ion-label>
                    <ion-input formControlName="nama" class="-mb-2 ion-text-capitalize"
                      (click)="bukaAutocomplete(autocomplateModal, 'atk', permintaanForm.get('variasi')['controls'][i].get('nama'))">
                    </ion-input>
                  </ion-item>
                  <div class="flex gap-3">
                    <ion-item fill="outline" class="item-rounded-xl">
                      <ion-label position="floating" color="medium" class="text-center">Jumlah</ion-label>
                      <ion-input formControlName="jumlah" type="number" class="-mb-2 ion-text-capitalize text-center">
                      </ion-input>
                    </ion-item>
                    <ion-item fill="outline" class="item-rounded-xl">
                      <ion-label position="floating" color="medium" class="text-center">Satuan</ion-label>
                      <ion-input formControlName="satuan" class="-mb-2 ion-text-capitalize text-center"></ion-input>
                    </ion-item>
                  </div>
                  <div *ngIf="c > 1" class="ion-padding-top text-medium text-center" (click)="hapusVariasi(i)">Hapus Variasi
                    ATK</div>
                </ng-container>
              </div>
              <div class="text-bold text-atk text-center" (click)="tambahVariasi()">+ Tambah ATK</div>
            </div>
    
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
              <ion-label position="floating" color="medium">Catatan </ion-label>
              <ion-textarea formControlName="catatan" placeholder="Tulis Catatan..." class="first-uppercase"></ion-textarea>
            </ion-item>
          </ion-list>
        </div>
    
        <!-- FORM snack ============================================================= -->
        <div *ngSwitchCase="'snack'">
          <ion-list class="pb-0">
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
              <ion-label position="floating" color="medium">Judul Rapat / Kegiatan</ion-label>
              <ion-input formControlName="judul" class="-mb-2 ion-text-capitalize"></ion-input>
            </ion-item>
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
              <ion-label position="floating" color="medium">Tempat Rapat / Kegiatan</ion-label>
              <ion-input formControlName="tempat" class="-mb-2"></ion-input>
            </ion-item>
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
              <ion-label position="floating" color="medium">Jumlah Peserta</ion-label>
              <ion-input formControlName="jumlah" type="number" class="-mb-2 ion-text-capitalize"></ion-input>
              <div slot="end" class="border-l pl-3 ml-3" style="border-color: var(--ion-color-light-shade);">Orang</div>
            </ion-item>
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl item-opacity-100"
              (click)="bukaTgl(tglModal, 'Pelaksanaan')">
              <ion-icon slot="start" name="calendar" color="medium" style="margin-top: 11px;"></ion-icon>
              <ion-label position="floating" color="medium">Tanggal Pelaksanaan</ion-label>
              <ion-input [value]="permintaanForm.get('tgl').value | date:'dd MMMM yyyy'" readonly="true"
                class="-mb-2 ion-text-capitalize"></ion-input>
            </ion-item>
            <div class="bg-background rounded-xl border ion-padding ion-margin-bottom">
              <div><b>Pengambilan</b></div>
              <ion-list class="p-0">
                <ion-radio-group formControlName="pengambilan" class="grid grid-cols-2 gap-3">
                  <ion-item lines="none" style="--padding-start: 0px;">
                    <ion-label>Diantar</ion-label>
                    <ion-radio slot="start" value="diantar" color="snack" class="ml-2 mr-2"></ion-radio>
                  </ion-item>
                  <ion-item lines="none" style="--padding-start: 0px; --inner-padding-end: 0;">
                    <ion-label>Diambil Sendiri</ion-label>
                    <ion-radio slot="start" value="diambilSendiri" color="snack" class="ml-2 mr-2"></ion-radio>
                  </ion-item>
                </ion-radio-group>
              </ion-list>
            </div>
            <div class="bg-background rounded-xl border ion-padding ion-margin-bottom">
              <div><b>Perihal</b></div>
              <form formGroupName="perihal">
                <ion-list mode="ios" class="p-0 grid grid-cols-2" style="gap: 0 0.75rem">
                  <ion-item lines="none" style="--padding-start: 0px;">
                    <ion-checkbox formControlName="snackPagi" slot="start" color="snack" class="ml-2 mr-2"
                      style="height: 20px; width: 20px;">
                    </ion-checkbox>
                    <ion-label>Snack Pagi</ion-label>
                  </ion-item>
                  <ion-item lines="none" style="--padding-start: 0px;">
                    <ion-checkbox formControlName="makanSiang" slot="start" color="snack" class="ml-2 mr-2"
                      style="height: 20px; width: 20px;">
                    </ion-checkbox>
                    <ion-label>Makan Siang</ion-label>
                  </ion-item>
                  <ion-item lines="none" style="--padding-start: 0px;">
                    <ion-checkbox formControlName="snackSore" slot="start" color="snack" class="ml-2 mr-2"
                      style="height: 20px; width: 20px;">
                    </ion-checkbox>
                    <ion-label>Snack Sore</ion-label>
                  </ion-item>
                  <ion-item lines="none" style="--padding-start: 0px;">
                    <ion-checkbox formControlName="makanMalam" slot="start" color="snack" class="ml-2 mr-2"
                      style="height: 20px; width: 20px;">
                    </ion-checkbox>
                    <ion-label class="mr-0">Makan Malam</ion-label>
                  </ion-item>
                </ion-list>
              </form>
            </div>
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
              <ion-label position="floating" color="medium">Cost Center</ion-label>
              <ion-input formControlName="costCenter" class="-mb-2"></ion-input>
            </ion-item>
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
              <ion-label position="floating" color="medium">G/L. Acount</ion-label>
              <ion-input formControlName="GLAccount" class="-mb-2"></ion-input>
            </ion-item>
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
              <ion-label position="floating" color="medium">PIC Kegiatan </ion-label>
              <ion-input formControlName="pic" class="-mb-2"></ion-input>
            </ion-item>
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
              <ion-label position="floating" color="medium">Catatan </ion-label>
              <ion-textarea formControlName="catatan" placeholder="Tulis Catatan..." class="first-uppercase"></ion-textarea>
            </ion-item>
          </ion-list>
        </div>
    
        <!-- FORM krp =============================================================== -->
        <div *ngSwitchCase="'krp'">
          <ion-list class="pb-0">
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl item-opacity-100"
              (click)="bukaTgl(tglModal, 'Keberangkatan', 'tglKeberangkatan')">
              <ion-icon slot="start" name="calendar" color="medium" style="margin-top: 11px;"></ion-icon>
              <ion-label position="floating" color="medium">Tanggal Keberangkatan</ion-label>
              <ion-input [value]="permintaanForm.get('tglKeberangkatan').value | date:'dd MMMM yyyy'" readonly="true"
                class="-mb-2 ion-text-capitalize"></ion-input>
            </ion-item>
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl item-opacity-100"
              (click)="bukaTgl(tglModal, 'Kembali', 'tglKembali')">
              <ion-icon slot="start" name="calendar" color="medium" style="margin-top: 11px;"></ion-icon>
              <ion-label position="floating" color="medium">Tanggal Kembali</ion-label>
              <ion-input [value]="permintaanForm.get('tglKembali').value | date:'dd MMMM yyyy'" readonly="true"
                class="-mb-2 ion-text-capitalize"></ion-input>
            </ion-item>
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
              <ion-label position="floating" color="medium">Tempat Tujuan</ion-label>
              <ion-input formControlName="tempatTujuan" class="-mb-2 ion-text-capitalize"></ion-input>
            </ion-item>
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
              <ion-label position="floating" color="medium">Tempat Penjemputan</ion-label>
              <ion-input formControlName="tempatPenjemputan" class="-mb-2 ion-text-capitalize"></ion-input>
            </ion-item>
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl item-opacity-100"
              (click)="bukaWaktu(waktuModal, 'Penjemputan', 'waktuPenjemputan')">
              <ion-icon slot="start" name="time" color="medium" style="margin-top: 11px;"></ion-icon>
              <ion-label position="floating" color="medium">Waktu Penjemputan</ion-label>
              <ion-input [value]="permintaanForm.get('waktuPenjemputan').value | date:'HH:mm'" readonly="true"
                class="-mb-2 ion-text-capitalize"></ion-input>
            </ion-item>
            <!-- <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
              <ion-label position="floating" color="medium">Jam Penjemputan</ion-label>
              <ion-input formControlName="jamPenjemputan" class="-mb-2 ion-text-capitalize"></ion-input>
            </ion-item> -->
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
              <ion-label position="floating" color="medium">Jumlah Penumpang</ion-label>
              <ion-input formControlName="jumlahPenumpang" class="-mb-2 ion-text-capitalize"></ion-input>
              <div slot="end" class="ion-padding-start border-l text-medium">Orang</div>
            </ion-item>
            <div class="bg-background rounded-xl border ion-padding ion-margin-bottom">
              <div><b>Jenis Pelayanan</b></div>
              <ion-list class="p-0">
                <ion-radio-group formControlName="jenisPelayanan" class="grid grid-cols-2 gap-3">
                  <ion-item lines="none" style="--padding-start: 0px;">
                    <ion-label>Dropoff</ion-label>
                    <ion-radio slot="start" value="dropoff" color="krp" class="ml-2 mr-2"></ion-radio>
                  </ion-item>
                  <ion-item lines="none" style="--padding-start: 0px; --inner-padding-end: 0;">
                    <ion-label>Full Service</ion-label>
                    <ion-radio slot="start" value="full service" color="krp" class="ml-2 mr-2"></ion-radio>
                  </ion-item>
                </ion-radio-group>
              </ion-list>
            </div>
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
              <ion-label position="floating" color="medium">Catatan </ion-label>
              <ion-textarea formControlName="catatan" placeholder="Tulis Catatan..." class="first-uppercase"></ion-textarea>
            </ion-item>
          </ion-list>
        </div>
    
        <!-- FORM mess ============================================================== -->
        <div *ngSwitchCase="'mess'">
          <ion-list class="pb-0">
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
              <ion-label position="floating" color="medium">Nama Tamu (Penanggung Jawab)</ion-label>
              <ion-input formControlName="penanggungJawab" class="-mb-2 ion-text-capitalize"></ion-input>
            </ion-item>
            <div class="grid grid-cols-2 gap-3">
              <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl item-opacity-100"
                (click)="bukaTgl(tglModal, 'Check In', 'checkIn')">
                <ion-icon slot="start" name="calendar" color="medium" style="margin-top: 11px;"></ion-icon>
                <ion-label position="floating" color="medium">Check In</ion-label>
                <ion-input [value]="permintaanForm.get('checkIn').value | date:'dd MMM yyyy'" readonly="true"
                  class="-mb-2 ion-text-capitalize"></ion-input>
              </ion-item>
              <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl item-opacity-100"
                (click)="bukaTgl(tglModal, 'Check Out', 'checkOut')">
                <ion-icon slot="start" name="calendar" color="medium" style="margin-top: 11px;"></ion-icon>
                <ion-label position="floating" color="medium">Check Out</ion-label>
                <ion-input [value]="permintaanForm.get('checkOut').value | date:'dd MMM yyyy'" readonly="true"
                  class="-mb-2 ion-text-capitalize"></ion-input>
              </ion-item>
            </div>
            <div class="grid grid-cols-2 gap-3">
              <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
                <ion-label position="floating" color="medium">Jumlah Tamu</ion-label>
                <ion-input formControlName="jumlahTamu" type="number" class="-mb-2 text-center"></ion-input>
                <!-- <div slot="end" class="border-l pl-3 ml-3" style="border-color: var(--ion-color-light-shade);">Orang</div> -->
              </ion-item>
              <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
                <ion-label position="floating" color="medium">Jumlah Kamar</ion-label>
                <ion-input formControlName="jumlahKamar" type="number" class="-mb-2 text-center"></ion-input>
                <!-- <div slot="end" class="border-l pl-3 ml-3" style="border-color: var(--ion-color-light-shade);">Kamar</div> -->
              </ion-item>
            </div>
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
              <ion-label position="floating" color="medium">Catatan </ion-label>
              <ion-textarea formControlName="catatan" placeholder="Tulis Catatan..." class="first-uppercase"></ion-textarea>
            </ion-item>
          </ion-list>
        </div>
    
        <!-- FORM dokumen =========================================================== -->
        <div *ngSwitchCase="'dokumen'">
          <ion-list class="pb-0">
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
              <ion-label position="floating" color="medium">Nama Pengirim</ion-label>
              <ion-input formControlName="namaPengirim" class="-mb-2 ion-text-capitalize"></ion-input>
            </ion-item>
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
              <ion-label position="floating" color="medium">Alamat Pengirim </ion-label>
              <ion-textarea formControlName="alamatPengirim" placeholder="Tulis Alamat Pengirim..."></ion-textarea>
            </ion-item>
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
              <ion-label position="floating" color="medium">No Tlp Pengirim</ion-label>
              <ion-input formControlName="noTlpPengirim" type="tel" class="-mb-2"></ion-input>
            </ion-item>
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
              <ion-label position="floating" color="medium">Nama Penerima</ion-label>
              <ion-input formControlName="namaPenerima" class="-mb-2 ion-text-capitalize"></ion-input>
            </ion-item>
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
              <ion-label position="floating" color="medium">Alamat Penerima </ion-label>
              <ion-textarea formControlName="alamatPenerima" placeholder="Tulis Alamat Penerima..."></ion-textarea>
            </ion-item>
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
              <ion-label position="floating" color="medium">No Tlp Penerima</ion-label>
              <ion-input formControlName="noTlpPenerima" type="tel" class="-mb-2"></ion-input>
            </ion-item>
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
              <ion-label position="floating" color="medium">Jenis Dokumen</ion-label>
              <ion-input formControlName="jenisDokumen" class="-mb-2 ion-text-capitalize"></ion-input>
            </ion-item>
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl item-opacity-100"
              (click)="bukaTgl(tglModal, 'Pengiriman', 'tglPengiriman')">
              <ion-icon slot="start" name="calendar" color="medium" style="margin-top: 11px;"></ion-icon>
              <ion-label position="floating" color="medium">Tgl Pengiriman</ion-label>
              <ion-input [value]="permintaanForm.get('tglPengiriman').value | date:'dd MMMM yyyy'" readonly="true"
                class="-mb-2 ion-text-capitalize"></ion-input>
            </ion-item>
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
              <ion-label position="floating" color="medium">Catatan </ion-label>
              <ion-textarea formControlName="catatan" placeholder="Tulis Catatan..." class="first-uppercase"></ion-textarea>
            </ion-item>
          </ion-list>
    
        </div>
    
        <!-- FORM galon ============================================================= -->
        <div *ngSwitchCase="'galon'">
          <ion-list class="pb-0">
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
              <ion-label position="floating" color="medium">Jumlah Galon</ion-label>
              <ion-input formControlName="jumlah" type="number" class="-mb-2"></ion-input>
              <div slot="end" class="border-l pl-3 ml-3" style="border-color: var(--ion-color-light-shade);">Galon</div>
            </ion-item>
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
              <ion-label position="floating" color="medium">Tempat Pengiriman</ion-label>
              <ion-input formControlName="lokasi" class="-mb-2 ion-text-capitalize"></ion-input>
            </ion-item>
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl item-opacity-100"
              (click)="bukaTgl(tglModal, 'Diperlukan')">
              <ion-icon slot="start" name="calendar" color="medium" style="margin-top: 11px;"></ion-icon>
              <ion-label position="floating" color="medium">Tanggal Diperlukan</ion-label>
              <ion-input [value]="permintaanForm.get('tgl').value | date:'dd MMMM yyyy'" readonly="true"
                class="-mb-2 ion-text-capitalize"></ion-input>
            </ion-item>
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl item-opacity-100"
              (click)="bukaWaktu(waktuModal, 'Diperlukan', 'waktu')">
              <ion-icon slot="start" name="time" color="medium" style="margin-top: 11px;"></ion-icon>
              <ion-label position="floating" color="medium">Waktu Diperlukan</ion-label>
              <ion-input [value]="permintaanForm.get('waktu').value | date:'HH:mm'" readonly="true"
                class="-mb-2 ion-text-capitalize"></ion-input>
            </ion-item>
            <div class="bg-background rounded-xl border ion-padding ion-margin-bottom">
              <div><b>Jenis Pelayanan</b></div>
              <ion-list class="p-0">
                <ion-radio-group formControlName="jenisPelayanan" class="grid grid-cols-2 gap-3">
                  <ion-item lines="none" style="--padding-start: 0px; --inner-padding-end: 0;">
                    <ion-label>Diantar</ion-label>
                    <ion-radio slot="start" value="diantar" color="galon" class="ml-2 mr-2"></ion-radio>
                  </ion-item>
                  <ion-item lines="none" style="--padding-start: 0px; --inner-padding-end: 0;">
                    <ion-label>Diambil Sendiri</ion-label>
                    <ion-radio slot="start" value="diambil sendiri" color="galon" class="ml-2 mr-2"></ion-radio>
                  </ion-item>
                </ion-radio-group>
              </ion-list>
            </div>
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
              <ion-label position="floating" color="medium">Catatan </ion-label>
              <ion-textarea formControlName="catatan" placeholder="Tulis Catatan..." class="first-uppercase"></ion-textarea>
            </ion-item>
          </ion-list>
        </div>
    
        <!-- FORM acara ============================================================= -->
        <div *ngSwitchCase="'acara'">
          <ion-list class="pb-0">
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
              <ion-label position="floating" color="medium">Nama Acara</ion-label>
              <ion-input formControlName="nama" class="-mb-2 ion-text-capitalize"></ion-input>
            </ion-item>
            <div class="bg-background rounded-xl border ion-padding ion-margin-bottom">
              <div><b>Jenis Acara</b></div>
              <ion-list class="p-0">
                <ion-radio-group formControlName="jenis" class="grid grid-cols-2" style="gap: 0 0.75rem;">
                  <ion-item lines="none" style="--padding-start: 0px; --inner-padding-end: 0;">
                    <ion-label>Full Day</ion-label>
                    <ion-radio slot="start" value="full day" color="acara" class="ml-2 mr-2"></ion-radio>
                  </ion-item>
                  <ion-item lines="none" style="--padding-start: 0px; --inner-padding-end: 0;">
                    <ion-label>Half Day</ion-label>
                    <ion-radio slot="start" value="half day" color="acara" class="ml-2 mr-2"></ion-radio>
                  </ion-item>
                  <ion-item lines="none" style="--padding-start: 0px; --inner-padding-end: 0;">
                    <ion-label>Full Board</ion-label>
                    <ion-radio slot="start" value="full board" color="acara" class="ml-2 mr-2"></ion-radio>
                  </ion-item>
                </ion-radio-group>
              </ion-list>
            </div>
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
              <ion-label position="floating" color="medium">Cost Center</ion-label>
              <ion-input formControlName="costCenter" class="-mb-2"></ion-input>
            </ion-item>
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
              <ion-label position="floating" color="medium">GL Account</ion-label>
              <ion-input formControlName="GLAccount" class="-mb-2"></ion-input>
            </ion-item>
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl item-opacity-100"
              (click)="bukaTgl(tglModal, 'Pelaksanaan')">
              <ion-icon slot="start" name="calendar" color="medium" style="margin-top: 11px;"></ion-icon>
              <ion-label position="floating" color="medium">Tanggal Pelaksanaan</ion-label>
              <ion-input [value]="permintaanForm.get('tgl').value | date:'dd MMMM yyyy'" readonly="true"
                class="-mb-2 ion-text-capitalize"></ion-input>
            </ion-item>
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl item-opacity-100"
              (click)="bukaWaktu(waktuModal, 'Pelaksanaan', 'waktu')">
              <ion-icon slot="start" name="time" color="medium" style="margin-top: 11px;"></ion-icon>
              <ion-label position="floating" color="medium">Waktu Pelaksanaan</ion-label>
              <ion-input [value]="permintaanForm.get('waktu').value | date:'HH:mm'" readonly="true"
                class="-mb-2 ion-text-capitalize"></ion-input>
            </ion-item>
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
              <ion-label position="floating" color="medium">Tempat Acara</ion-label>
              <ion-input formControlName="tempat" class="-mb-2 ion-text-capitalize"></ion-input>
            </ion-item>
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
              <ion-label position="floating" color="medium">Jumlah Peserta</ion-label>
              <ion-input formControlName="jumlah" type="number" class="-mb-2"></ion-input>
              <div slot="end" class="border-l pl-3 ml-3" style="border-color: var(--ion-color-light-shade);">Orang</div>
            </ion-item>
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
              <ion-label position="floating" color="medium">PIC Acara</ion-label>
              <ion-input formControlName="pic" class="-mb-2"></ion-input>
            </ion-item>
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
              <ion-label position="floating" color="medium">No Tlp PIC</ion-label>
              <ion-input formControlName="noTlpPic" type="tel" class="-mb-2"></ion-input>
            </ion-item>
            <div class="bg-background rounded-xl border ion-padding ion-margin-bottom">
              <div class="text-bold ion-margin-bottom">Kebutuhan Acara</div>
              <div formArrayName="variasi" *ngFor="let pe of permintaanForm.get('variasi')['controls']; let i = index; let c = count;"
                class="ion-padding border rounded-xl ion-margin-bottom">
                <ng-container [formGroupName]="i">
                  <!-- <div class="text-medium mb-2">Kebutuhan {{i + 1}}</div> -->
                  <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
                    <ion-label position="floating" color="medium" class="text-center">Nama Kebutuhan</ion-label>
                    <ion-input formControlName="nama" class="-mb-2 ion-text-capitalize"></ion-input>
                  </ion-item>
                  <div class="flex gap-3 ion-margin-bottom">
                    <ion-item fill="outline" class="item-rounded-xl">
                      <ion-label position="floating" color="medium" class="text-center">Jumlah</ion-label>
                      <ion-input formControlName="jumlah" type="number" class="-mb-2 text-center"></ion-input>
                    </ion-item>
                    <ion-item fill="outline" class="item-rounded-xl">
                      <ion-label position="floating" color="medium" class="text-center">Satuan</ion-label>
                      <ion-input formControlName="satuan" class="-mb-2 text-center ion-text-capitalize"></ion-input>
                    </ion-item>
                  </div>
                  <ion-item fill="outline" class="item-rounded-xl item-opacity-100"
                    (click)="bukaTglVariasi(tglVariasiModal, 'Kebutuhan', i)">
                    <ion-icon slot="start" name="calendar" color="medium" style="margin-top: 11px;"></ion-icon>
                    <ion-label position="floating" color="medium">Tanggal Dibutuhkan</ion-label>
                    <ion-input [value]="permintaanForm.get('variasi')['controls'][i].get('tgl').value | date:'dd MMMM yyyy'"
                      readonly="true" class="-mb-2 ion-text-capitalize"></ion-input>
                  </ion-item>
                  <div *ngIf="c > 1" class="ion-padding-top text-medium text-center" (click)="hapusVariasi(i)">Hapus
                    Kebutuhan</div>
                </ng-container>
              </div>
              <div class="text-bold text-acara text-center" (click)="tambahVariasi()">+ Tambah Kebutuhan Acara</div>
            </div>
    
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
              <ion-label position="floating" color="medium">Catatan </ion-label>
              <ion-textarea formControlName="catatan" placeholder="Tulis Catatan..." class="first-uppercase"></ion-textarea>
            </ion-item>
          </ion-list>
        </div>
    
        <!-- FORM peralatan ========================================================= -->
        <div *ngSwitchCase="'peralatan'">
          <ion-list class="pb-0">
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
              <ion-label position="floating" color="medium">Lokasi Kerja</ion-label>
              <ion-input formControlName="alamat" class="-mb-2 ion-text-capitalize"></ion-input>
            </ion-item>
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl item-opacity-100"
              (click)="bukaTgl(tglModal, 'Diperlukan')">
              <ion-icon slot="start" name="calendar" color="medium" style="margin-top: 11px;"></ion-icon>
              <ion-label position="floating" color="medium">Tanggal Diperlukan</ion-label>
              <ion-input [value]="permintaanForm.get('tgl').value | date:'dd MMMM yyyy'" readonly="true"
                class="-mb-2 ion-text-capitalize"></ion-input>
            </ion-item>
            <div class="bg-background rounded-xl border ion-padding ion-margin-bottom">
              <div class="text-bold ion-margin-bottom">Variasi Peralatan</div>
              <div formArrayName="variasi" *ngFor="let pe of permintaanForm.get('variasi')['controls']; let i = index; let c = count;"
                class="ion-padding border rounded-xl ion-margin-bottom">
                <ng-container [formGroupName]="i">
                  <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl" style="max-height: 57px;">
                    <ion-label position="floating" color="medium">Nama Peralatan</ion-label>
                    <ion-select formControlName="nama" [interfaceOptions]="{ mode: 'ios', cssClass: 'item-peralatan' }"
                      okText="Pilih" cancelText="Batal" class="mb-px">
                      <ion-select-option value="Lampu">Lampu</ion-select-option>
                      <ion-select-option value="Kebersihan">Kebersihan</ion-select-option>
                      <ion-select-option value="Lainnya">Lainnya</ion-select-option>
                    </ion-select>
                  </ion-item>
                  <div class="flex gap-3">
                    <ion-item fill="outline" class="item-rounded-xl">
                      <ion-label position="floating" color="medium" class="text-center">Jumlah</ion-label>
                      <ion-input formControlName="jumlah" type="number" class="-mb-2 ion-text-capitalize text-center">
                      </ion-input>
                    </ion-item>
                    <ion-item *ngIf="permintaanForm.get('variasi')['controls'][i].get('nama') as na" fill="outline"
                      class="item-rounded-xl">
                      <ion-label position="floating" color="medium" class="text-center">{{na.value == 'Lampu'? 'Daya' :
                        'Satuan'}}</ion-label>
                      <ion-input formControlName="satuan" [type]="na.value == 'Lampu'? 'number' : 'text'"
                        class="-mb-2 ion-text-capitalize text-center"></ion-input>
                      <div *ngIf="na.value == 'Lampu'" slot="end" class="border-l pl-3 ml-3"
                        style="border-color: var(--ion-color-light-shade);">Watt</div>
                    </ion-item>
                  </div>
                  <div *ngIf="c > 1" class="ion-padding-top text-medium text-center" (click)="hapusVariasi(i)">Hapus Variasi
                    Peralatan</div>
                </ng-container>
              </div>
              <div class="text-bold text-peralatan text-center" (click)="tambahVariasi()">+ Tambah Peralatan</div>
            </div>
    
            <ion-item fill="outline" class="ion-margin-bottom item-rounded-xl">
              <ion-label position="floating" color="medium">Catatan </ion-label>
              <ion-textarea formControlName="catatan" placeholder="Tulis Catatan..." class="first-uppercase"></ion-textarea>
            </ion-item>
          </ion-list>
        </div>
      </container-element>
  
      <!-- Modal datetime -->
      <ion-modal #tglModal trigger="tglModal" class="items-end" style="--height: 406px;">
        <ng-template>
          <ion-header>
            <ion-toolbar>
              <ion-buttons slot="start" class="-mr-4">
                <ion-button (click)="tglModal.dismiss()">
                  <ion-icon slot="icon-only" name="close"></ion-icon>
                </ion-button>
              </ion-buttons>
              <ion-title>{{titleTgl}}</ion-title>
            </ion-toolbar>
          </ion-header>
          <ion-content>
            <ion-datetime mode="md" [min]="minTgl" presentation="date" [formControlName]="fcmTgl" locale="id-ID"
              [ngClass]="'item-' + kategori.kode" class="max-w-full w-full" (ionChange)="tglModal.dismiss()">
            </ion-datetime>
          </ion-content>
        </ng-template>
      </ion-modal>
  
      <button type="submit"
        [ngClass]="'bg-' + kategori.kode + ' text-on-' + kategori.kode + (permintaanForm.invalid? ' opacity-50' : '')"
        class="w-full flex items-center justify-center text-center rounded-xl ion-padding relative"
        (click)="bukaKonfirmasi(konfirmasiModal)">
        <h6 class="ion-no-margin text-bold">{{idPermintaan? 'Simpan Revisi Permintaan' : 'Tambah Permintaan'}}</h6>
        <!-- <ion-spinner [class.opacity-0]="!isLoading" color="light" class="absolute"></ion-spinner> -->
      </button>
    </form>
  </div>

  <ng-template #noKategori>
    <div class="h-full flex flex-col gap-4 items-center justify-center">
      <div>
        Link Tidak Valid
      </div>
      <div class="ion-padding border rounded-xl text-center" routerLink="/">
        Kembali Ke Beranda
      </div>
    </div>
  </ng-template>
</ion-content>

<ion-modal #tglVariasiModal class="items-end" style="--height: 406px;">
  <ng-template>
    <ion-header>
      <ion-toolbar>
        <ion-buttons slot="start" class="-mr-4">
          <ion-button (click)="tglVariasiModal.dismiss()">
            <ion-icon slot="icon-only" name="close"></ion-icon>
          </ion-button>
        </ion-buttons>
        <ion-title>Pilih Tanggal Kebutuhan</ion-title>
      </ion-toolbar>
    </ion-header>
    <ion-content>
      <ion-datetime #tglVariasi mode="md" [min]="minTgl"
        [value]="permintaanForm.get('variasi')['controls'][iVariasiModal].get(fcmTglVariasi).value" presentation="date"
        locale="id-ID" [ngClass]="'item-' + kategori.kode" class="max-w-full w-full"
        (ionChange)="pilihVariasiTgl(tglVariasiModal, tglVariasi)">
      </ion-datetime>
    </ion-content>
  </ng-template>
</ion-modal>

<ion-modal #waktuModal class="items-end" style="--height: 342px;" (ionModalDidDismiss)="dismissWaktu()">
  <ng-template>
    <ion-header>
      <ion-toolbar>
        <ion-buttons slot="start" class="-mr-4">
          <ion-button (click)="waktuModal.dismiss()">
            <ion-icon slot="icon-only" name="close"></ion-icon>
          </ion-button>
        </ion-buttons>
        <ion-title><b>{{titleWaktu}}</b></ion-title>
      </ion-toolbar>
    </ion-header>
    <ion-content>
      <div class="h-full flex flex-col">
        <div class="flex-1">
          <ion-datetime *ngIf="showWaktu" [(ngModel)]="valueWaktu" mode="md" presentation="time" locale="id-ID"
            [ngClass]="'item-' + kategori.kode" class="max-w-full w-full">
          </ion-datetime>
        </div>
        <div class="grid grid-cols-2 gap-3 ion-padding">
          <div [ngClass]="'bg-' + kategori.kode + '-tint text-' + kategori.kode"
            class="ion-padding rounded-xl text-center" (click)="waktuModal.dismiss()"><b>Batal</b>
          </div>
          <div [ngClass]="'bg-' + kategori.kode + ' text-on-' + kategori.kode"
            class="ion-padding rounded-xl text-center" (click)="pilihWaktu(waktuModal)"><b>Pilih</b>
          </div>
        </div>
      </div>
    </ion-content>
  </ng-template>
</ion-modal>

<ion-modal #autocomplateModal class="items-end" style="--max-height: 60%;" (ionModalDidDismiss)="dismissAutocomplate()">
  <ng-template>
    <ion-header>
      <ion-toolbar>
        <ion-buttons slot="start">
          <ion-button (click)="autocomplateModal.dismiss()">
            <ion-icon slot="icon-only" name="close"></ion-icon>
          </ion-button>
        </ion-buttons>
        <ion-title class="pl-0 ion-text-capitalize"><b>Pilih {{autocomplateTitle}}</b></ion-title>
      </ion-toolbar>

      <ion-toolbar style="margin-top: -16px;">
        <form [ngClass]="'item-' + kategori.kode" class="ion-padding-start ion-padding-end ion-padding-top pb-2">
          <ion-item fill="outline" class="item-rounded-xl" style="max-height: 57px;">
            <ion-label position="floating" color="medium" class="ion-text-capitalize">Tulis Nama {{autocomplateTitle}}
            </ion-label>
            <ion-input [formControl]="autocomplateForm" class="-mb-2 ion-text-capitalize"></ion-input>
            <div *ngIf="autocomplateForm as af" slot="end">
              <ion-icon *ngIf="af.value" name="close" style="font-size: 18pt;" (click)="af.setValue('')"></ion-icon>
            </div>
          </ion-item>
          <div class="text-medium"><small>Tulis nama {{autocomplateTitle}} jika tidak tersedia dibawah</small></div>
        </form>
      </ion-toolbar>
    </ion-header>
    <ion-content [ngClass]="'item-' + kategori.kode">
      <ion-list>
        <ng-container *ngFor="let ac of autocomplate; trackBy: trackByFn">
          <ion-item *ngIf="ac.jenis != 'divider'; else acDivider" (click)="pilihAutocomplate(ac.nama)">
            <ion-label>{{ac.nama}}</ion-label>
          </ion-item>
          <ng-template #acDivider>
            <ion-item-divider [ngClass]="'bg-' + kategori.kode + '-tint text-' + kategori.kode">
              <ion-label>
                <div class="text-xl text-bold ion-text-capitalize">{{ac.nama}}</div>
              </ion-label>
            </ion-item-divider>
          </ng-template>
        </ng-container>
      </ion-list>
    </ion-content>
    <ion-footer>
      <div class="h-full flex flex-col">
        <div class="grid grid-cols-2 gap-3 ion-padding">
          <button [ngClass]="'bg-' + kategori.kode + '-tint text-' + kategori.kode"
            class="ion-padding rounded-xl text-center" (click)="autocomplateModal.dismiss()">
            <h5 class="ion-no-margin">Batal</h5>
          </button>
          <button [disabled]="autocomplateForm.invalid" [ngClass]="'bg-' + kategori.kode + ' text-on-' + kategori.kode"
            class="ion-padding rounded-xl text-center" (click)="simpanAutocomplate(autocomplateModal)">
            <h5 class="ion-no-margin">Simpan</h5>
          </button>
        </div>
      </div>
    </ion-footer>
  </ng-template>
</ion-modal>

<ion-modal #konfirmasiModal class="modal-konfirmasi">
  <ng-template>
    <div class="ion-padding ion-margin bg-background rounded-xl text-center" style="color: var(--ion-text-color, #000)">
      <div class="ion-padding flex items-center justify-center">
        <svg width="100%" height="100%" viewBox="0 0 269 258" fill="none" xmlns="http://www.w3.org/2000/svg">
          <g clip-path="url(#clip0_239_2457)">
            <path
              d="M137.529 231.267C194.043 231.267 239.856 185.48 239.856 129C239.856 72.5197 194.043 26.7334 137.529 26.7334C81.0159 26.7334 35.2026 72.5197 35.2026 129C35.2026 185.48 81.0159 231.267 137.529 231.267Z"
              fill="url(#color)" />
            <path opacity="0.75"
              d="M258.152 50.2118C264.143 50.2118 269 45.3578 269 39.3701C269 33.3823 264.143 28.5283 258.152 28.5283C252.161 28.5283 247.304 33.3823 247.304 39.3701C247.304 45.3578 252.161 50.2118 258.152 50.2118Z"
              fill="url(#color)" />
            <path opacity="0.54"
              d="M30.2934 28.672C38.2156 28.672 44.6378 22.2535 44.6378 14.336C44.6378 6.41844 38.2156 0 30.2934 0C22.3712 0 15.949 6.41844 15.949 14.336C15.949 22.2535 22.3712 28.672 30.2934 28.672Z"
              fill="url(#color)" />
            <path opacity="0.72"
              d="M17.2659 197.114C21.3394 197.114 24.6417 193.814 24.6417 189.743C24.6417 185.671 21.3394 182.371 17.2659 182.371C13.1924 182.371 9.89014 185.671 9.89014 189.743C9.89014 193.814 13.1924 197.114 17.2659 197.114Z"
              fill="url(#color)" />
            <path
              d="M92.1493 258.024C95.2309 258.024 97.729 255.527 97.729 252.448C97.729 249.368 95.2309 246.871 92.1493 246.871C89.0677 246.871 86.5696 249.368 86.5696 252.448C86.5696 255.527 89.0677 258.024 92.1493 258.024Z"
              fill="url(#color)" />
            <path
              d="M177.33 247.422C178.904 247.422 180.179 246.147 180.179 244.574C180.179 243.001 178.904 241.726 177.33 241.726C175.756 241.726 174.48 243.001 174.48 244.574C174.48 246.147 175.756 247.422 177.33 247.422Z"
              fill="url(#color)" />
            <path
              d="M239.114 232.774C241.111 232.774 242.73 231.156 242.73 229.16C242.73 227.164 241.111 225.546 239.114 225.546C237.117 225.546 235.498 227.164 235.498 229.16C235.498 231.156 237.117 232.774 239.114 232.774Z"
              fill="url(#color)" />
            <path opacity="0.93"
              d="M246.322 161.597C248.319 161.597 249.938 159.979 249.938 157.983C249.938 155.987 248.319 154.369 246.322 154.369C244.325 154.369 242.706 155.987 242.706 157.983C242.706 159.979 244.325 161.597 246.322 161.597Z"
              fill="url(#color)" />
            <path opacity="0.76"
              d="M154.795 9.66924C156.792 9.66924 158.411 8.05123 158.411 6.05532C158.411 4.05941 156.792 2.44141 154.795 2.44141C152.798 2.44141 151.179 4.05941 151.179 6.05532C151.179 8.05123 152.798 9.66924 154.795 9.66924Z"
              fill="url(#color)" />
            <path
              d="M3.61604 111.074C5.61313 111.074 7.23208 109.456 7.23208 107.46C7.23208 105.464 5.61313 103.846 3.61604 103.846C1.61896 103.846 0 105.464 0 107.46C0 109.456 1.61896 111.074 3.61604 111.074Z"
              fill="url(#color)" />
            <path
              d="M170.792 86.6144C171.726 86.3033 172.684 85.8246 173.69 85.8964C175.486 86.0161 177.066 87.4999 177.306 89.271C177.473 90.2522 177.066 91.1856 176.755 92.0712C166.074 122.323 155.394 152.574 144.689 182.85C144.282 183.999 143.372 184.956 142.223 185.387C140.882 185.865 139.349 185.387 138.343 184.429C137.649 183.783 137.314 182.874 136.931 182.036C131.59 170.596 126.25 159.156 120.886 147.692C126.657 141.924 132.428 136.156 138.2 130.388C138.894 129.718 139.421 128.809 139.445 127.827C139.493 125.434 137.05 123.328 134.68 123.854C133.65 124.07 132.883 124.86 132.189 125.578C126.609 131.154 121.054 136.707 115.474 142.283C103.596 136.707 91.6941 131.202 79.8163 125.649C78.116 124.86 77.1581 122.754 77.8047 120.959C78.1878 119.858 79.0739 118.948 80.1515 118.565C110.349 107.939 140.571 97.2886 170.792 86.6144Z"
              fill="white" />
          </g>
          <defs>
            <linearGradient id="color">
              <stop [attr.stop-color]="'rgb(var(--ion-color-' + kategori.kode + '-rgb))'" />
            </linearGradient>
          </defs>
        </svg>
      </div>
      <h5 [ngClass]="'text-' + kategori.kode"><b>Kirim Permintaan</b></h5>
      <div class="ion-margin-bottom"><b>Apakah Anda Yakin Mengirim <br> Permintaan Ini?</b></div>
      <div class="grid grid-cols-2 gap-4">
        <div [ngClass]="'bg-' + kategori.kode + '-tint text-' + kategori.kode"
          class="ion-padding rounded-xl text-center" (click)="konfirmasiModal.dismiss()"><b>Batal</b></div>
        <div [ngClass]="'bg-' + kategori.kode + ' text-on-' + kategori.kode" class="ion-padding rounded-xl text-center"
          (click)="kirim(konfirmasiModal)">
          <b>Kirim</b>
        </div>
      </div>
    </div>
  </ng-template>
</ion-modal>